[package]
name = "bestool"
version = "0.1.0"
edition = "2021"
publish = false

authors = ["FÃ©lix Saparelli <felix@passcod.name>", "BES Developers <contact@bes.au>"]
license = "UNLICENSED"
description = "BES Deployment tooling"
keywords = ["bes", "tamanu", "tupaia"]
categories = ["command-line-utilities"]
repository = "https://github.com/beyondessential/ops"

[dependencies]
aws-config = { version = "1.1.2", optional = true }
aws-credential-types = { version = "1.1.2", features = ["hardcoded-credentials"], optional = true }
aws-sdk-s3 = { version = "1.12.0", optional = true }
aws-sdk-sts = { version = "1.11.0", optional = true }
base64ct = { version = "1.6.0", features = ["std"] }
boxcar = "0.2.4"
bytes = "1.5.0"
chrono = "0.4.33"
clap = { version = "4.4.18", features = ["derive", "cargo", "wrap_help", "env", "unicode", "string"] }
clap_complete = "4.4.8"
clap_complete_nushell = "4.4.2"
dirs = "5.0.1"
duct = "0.13.7"
glob = "0.3.1"
humantime = "2.1.0"
indicatif = { version = "0.17.7", features = ["tokio"] }
json5 = "0.4.1"
leon = "2.0.1"
leon-macros = "1.0.0"
miette = { version = "5.10.0", features = ["fancy"] }
mimalloc = "0.1.39"
node-semver = "2.1.0"
serde = { version = "1.0.195", features = ["derive"] }
serde_json = "1.0.111"
tokio = { version = "1.35.1", features = ["full"] }
tracing = "0.1.40"
tracing-subscriber = { version = "0.3.18", features = ["env-filter", "json"] }
walkdir = "2.4.0"

[target.'cfg(target_os = "linux")'.dependencies]
dbus = { version = "0.9.7", optional = true }
networkmanager = { package = "passcod-networkmanager", version = "0.6.0", optional = true }

[build-dependencies]
build-data = "0.1.5"
windows_exe_info = { version = "0.4.1", features = ["manifest"] }

[features]
default = ["tamanu", "upload", "wifisetup"]

## Common dep groups (not meant to be used directly)
aws = ["dep:aws-config", "dep:aws-credential-types", "dep:aws-sdk-s3", "dep:aws-sdk-sts"]

## Subcommands
tamanu = []
upload = ["aws"]
wifisetup = ["dep:dbus", "dep:networkmanager"]

[profile.release]
lto = true
codegen-units = 1
strip = "symbols"

[profile.dev.build-override]
opt-level = 0
codegen-units = 1024
debug = false
debug-assertions = false
overflow-checks = false
incremental = false

[profile.release.build-override]
opt-level = 0
codegen-units = 1024
debug = false
debug-assertions = false
overflow-checks = false
incremental = false
